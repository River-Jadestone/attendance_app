<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
      .container { padding-top: 20px; }
      #results-table th, #results-table td { text-align: center; vertical-align: middle; }
      .modal-lg { max-width: 80%; }
      .tab-content { padding-top: 15px; }
      .table-responsive { max-height: 400px; }
      .modal-footer { justify-content: space-between; }
    </style>
  </head>
  <body>
    <div class="container">
      <h3 class="text-center mb-4">학생 관리 시스템</h3>
      <div class="row"><div class="col-md-8 offset-md-2">
        <form id="search-form"><div class="input-group mb-3">
          <input type="text" id="search-name" class="form-control" placeholder="학생 이름을 입력하세요..." required>
          <div class="input-group-append">
            <button class="btn btn-primary" type="submit">검색</button>
            <button class="btn btn-success" type="button" id="add-new-student-btn">신규 학생 추가</button>
          </div>
        </div></form>
      </div></div>
      <div id="loader" class="text-center" style="display: none;"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>
      <div id="search-results" class="mt-4"></div>
    </div>

    <!-- 신규 학생 추가 Modal -->
    <div class="modal" id="add-student-modal" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">신규 학생 추가</h5><button type="button" class="close" data-dismiss="modal">&times;</button></div>
      <div class="modal-body"><form id="add-student-form">
        <div class="form-group"><label for="new-name">이름</label><input type="text" class="form-control" id="new-name" required></div>
        <div class="form-group"><label for="new-age">나이</label><input type="number" class="form-control" id="new-age" required></div>
        <div class="form-group"><label for="new-school">학교</label><input type="text" class="form-control" id="new-school" required></div>
      </form></div>
      <div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button><button type="button" class="btn btn-primary" id="save-student-btn">저장</button></div>
    </div></div></div>

    <!-- 학생 상세 정보 Modal -->
    <div class="modal fade" id="student-details-modal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title" id="details-modal-title">학생 상세 정보</h5><button type="button" class="close" data-dismiss="modal">&times;</button></div>
      <div class="modal-body">
        <div id="details-loader" class="text-center" style="display: none;"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>
        <div id="details-content">
          <ul class="nav nav-tabs">
            <li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#info">기본정보</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#payments">납부 내역</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#attendance">출결 현황</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#progress">수업 진도</a></li>
          </ul>
          <div class="tab-content">
            <div id="info" class="container tab-pane active"><div id="info-content"></div></div>
            <div id="payments" class="container tab-pane fade"><div id="payments-content" class="table-responsive"></div></div>
            <div id="attendance" class="container tab-pane fade"><div id="attendance-content" class="table-responsive"></div></div>
            <div id="progress" class="container tab-pane fade"><div id="progress-content" class="table-responsive"></div></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div>
          <button type="button" class="btn btn-info" id="open-attendance-modal-btn">출결/진도 기록</button>
          <button type="button" class="btn btn-primary" id="open-payment-modal-btn">수강 신청/납부</button>
        </div>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
      </div>
    </div></div></div>

    <!-- 수강 신청 및 납부 Modal -->
    <div class="modal fade" id="payment-modal" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">수강 신청 및 납부</h5><button type="button" class="close" data-dismiss="modal">&times;</button></div>
      <div class="modal-body"><form id="payment-form">
        <input type="hidden" id="payment-student-id"><input type="hidden" id="payment-student-name">
        <div class="form-group"><label for="subject-select">과목 선택</label><select class="form-control" id="subject-select" required></select></div>
        <div class="form-group"><label for="months-select">수강 개월</label><select class="form-control" id="months-select"><option value="1">1개월</option><option value="3">3개월 (5% 할인)</option><option value="12">12개월 (별도 할인)</option></select></div>
        <hr>
        <div class="form-group"><label for="payment-method">결제 수단</label><select class="form-control" id="payment-method"><option>카드</option><option>현금</option><option>이체</option></select></div>
        <div class="form-group" id="card-company-group"><label for="card-company">카드사</label><input type="text" class="form-control" id="card-company" placeholder="카드사 입력"></div>
      </form></div>
      <div class="modal-footer"><button type="button" class="btn btn-success" id="record-payment-btn">납부 기록</button><button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button></div>
    </div></div></div>

    <!-- 출결 및 진도 기록 Modal -->
    <div class="modal fade" id="attendance-modal" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">출결 및 진도 기록</h5><button type="button" class="close" data-dismiss="modal">&times;</button></div>
      <div class="modal-body"><form id="attendance-form">
        <input type="hidden" id="attendance-student-id"><input type="hidden" id="attendance-student-name">
        <div class="form-group"><label for="class-date">수업 날짜</label><input type="date" class="form-control" id="class-date" required></div>
        <div class="form-group"><label for="attendance-status">출결 상태</label><select class="form-control" id="attendance-status"><option>출석</option><option>결석</option><option>보강</option></select></div>
        <div id="progress-details" class="mt-3 border-top pt-3">
          <h5>진도 내용 (출석 시 자동 기록)</h5>
          <div class="form-group"><label for="progress-subject">과목</label><select class="form-control" id="progress-subject" required></select></div>
          <div class="form-group"><label for="class-content">수업 내용</label><textarea class="form-control" id="class-content" rows="3"></textarea></div>
          <div class="form-group"><label for="teacher-name">수업 선생님</label><input type="text" class="form-control" id="teacher-name"></div>
        </div>
      </form></div>
      <div class="modal-footer"><button type="button" class="btn btn-info" id="record-attendance-btn">기록 저장</button><button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button></div>
    </div></div></div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <?!= include('javascript'); ?>
  </body>
</html>
